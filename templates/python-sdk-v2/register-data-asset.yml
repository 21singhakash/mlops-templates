# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.

parameters:
- name: dataAssetName
  type: string
  default: ''
- name: dataAssetDescription
  type: string
  default: ''
- name: dataAssetLocalPath
  type: string
  default: ''
- name: dataAssetType
  type: string
  default: ''

#cp config.json templates/src/python-sdk-v2/config.json

steps:

- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.10.4'
    architecture: 'x64'

- script: |
    pip install azure-ai-ml==1.0.0
    pip install azure-identity
    pip install azure-core
  displayName: 'Install python sdk v2 and azure-identity'
    
- task: AzureCLI@2
  displayName: Register training data asset
  inputs:
    azureSubscription: $(ado_service_connection_aml_ws)
    scriptType: bash
    scriptLocation: inlineScript
    inlineScript: |

      echo "Checking Directories for Config.json"
      echo "$(ls templates/src/python-sdk-v2/)"

      echo "$(pwd)"
      echo "$(ls templates/src/python-sdk-v2/)"


      python templates/src/python-sdk-v2/register_data_asset.py \
        -n "${{parameters.dataAssetName}}" \
        -d "${{parameters.dataAssetDescription}}" \
        -l "${{parameters.dataAssetLocalPath}}" \
        -t "${{parameters.dataAssetType}}" 
