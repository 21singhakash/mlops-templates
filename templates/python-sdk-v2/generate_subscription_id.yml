# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.
steps:
  - task: AzureCLI@2
    name: registersubsid
    displayName: Connect to AML Workspace using CLI v2
    inputs:
      azureSubscription: $(ado_service_connection_aml_ws)
      scriptType: bash
      scriptLocation: inlineScript
      inlineScript: |
        az configure --defaults group=$(resource_group) workspace=$(aml_workspace)
        AzureMLsubscription=$(az account list --query "[?isDefault].id" -o tsv)

        echo "##[debug]Creating variable with following value: $AzureMLsubscription" 
        echo "##vso[task.setvariable variable=env_subscription_id;isOutput=true]$AzureMLsubscription"
        
        echo "finished"
    target:
      settableVariables:
      - env_subscription_id

